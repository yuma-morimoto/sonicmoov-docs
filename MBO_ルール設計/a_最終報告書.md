# MBO最終報告：ルール設計

## 1. 目標概要

### 背景（As-Is）
- 前回の目標で実施した==「中長期プロジェクトにおけるエージェントルール設計」==を達成し、設計指針やルール体系を構築することができた。
- しかし、まだ社内で実際に利用できる段階には至っておらず、案件における運用ドキュメントや活用事例の整備が不足していた。
- ==現状では自分以外のメンバーが容易に使い始めることが難しく==、活用の標準化・共有の仕組みづくりが課題となっていた。

### 目指す姿（To-Be）
- 社内案件で活用できるようにルール設計を整理し、導入可能な形に整備する。
- 案件への導入ガイド（活用方法・設計指針・サンプル含む）を作成し、チーム内で共有・フィードバックを得る。
- 最終的には==「他メンバーがAI設計ルールを用いてプロジェクトに導入できる状態」==を目指す。

## 2. 目標達成状況

| 小目標                                      | 達成状況 | 補足                                   |
| ---------------------------------------- | ---- | ------------------------------------ |
| 前回のエージェントルール設計内容を整理し、社内案件でも利用できる構造へ再設計する | 達成   | ルールの役割を「精度向上」ではなく「案件固有のガードレール」に再定義した |
| ナビパーク案件などで試験導入し、運用上の改善点を収集する             | 達成   | ルールの有効な粒度や、不要な記述の傾向を整理できた            |
| 案件導入ガイドを作成し、他メンバーが参照可能な状態にする             | 達成   | 最小ルールセット、導入手順、運用方法を文書化した             |
| チーム内で共有する                                |      |                                      |

## 3. 実施内容と成果

### 3.1 ルール設計方針の再整理

- 既存のルール設計内容を見直し、==「ルールを増やすほど良い」という考え方を改めた==。
- ルール設計の目的を、AIの精度を万能に上げることではなく、==案件固有の前提・判断基準・制約をガードレールとして定義==することに整理した。
- その結果、他案件にも横展開しやすい「最小構成で始める」方針を明確化できた。

### 3.2 導入・運用ガイドの整備

- ガイドの構成を==「構築」と「運用」の2つに分けて整理==した。
- 構築面では、==最小構成で始める考え方==、ルールテンプレート、ルールを書くときのコツをまとめ、ゼロから作り始めなくてよい形にした。
- 運用面では、ルールファイルの管理方法、更新時の見直し方、ルール評価ポリシーを用いた評価方法を整理し、継続的に改善しやすい運用の型を用意した。
- あわせて、ナビパーク案件の実際のルール設計例や評価ポリシーを載せ、参照できる状態にした。

### 3.3 導入による検証と成果

- ナビパーク案件に加え、別案件でも構築済みルールを用いてルールを検証することができた。
- 実際の作業は要望対応やバグ対応が中心だったが、その中でも、案件固有のドメイン用語、実装時の判断基準といったルールは、実装時に効果を発揮した。
- 最初にルールを固定し切るのではなく、運用しながら細かなルール修正を行い、==実務で使いながら改善していく進め方==が効率が良いこともわかった。
- あわせて、ルールが実装判断にどの程度寄与したかを振り返るために、評価ポリシーと`RULES_USAGE_LOG.md`による記録運用も試した。
- 一方で、この記録運用はまだ安定しない場合があり、==特にバグ修正完了時点での記録徹底までは至らなかった。==
- このため、ルールそのものの内容だけでなく、評価ポリシー自体の判定精度を安定させることや、実際の作業フローに乗せるための記録タイミング・運用方法も、あわせて改善すべき課題であることが分かった。

### 3.4 主な成果物

- [ルールの構築・運用ガイド](https://sonicmoov.esa.io/posts/1553)

## 4. 未達項目と要因

- ルール導入による工数削減やレビュー時間短縮といった定量効果の測定までは実施できていない。

### 要因

- 今回の期間では、まずルールを導入可能な形に整理し、案件で運用の検証することを優先したため、効果を定量で検証する時間が取れなかった。

## 5. 得られた知見・学び

- 最初から完成形を目指すより、==最小ルールセット==から始めて、実践しながら改善する方が有効だった。
- ビジネスルールや==ドメイン用語==のような、コードベースだけでは推測しにくい案件固有情報は効果が高かった。
- ディレクトリ構成と役割を明文化すると、実装箇所の判断が安定しやすくなった。
- ==ルールの初稿はAI==に作らせた方が整理しやすいが、採用可否の判断は人が行う必要があると分かった。
- 強制指示を増やしても必ず守られるわけではなく、重要度に応じてメリハリをつけた記述が必要だった。
- ==細かなコーディングスタイル==は、現時点では依然として一定程度ルールに明記する必要がある。
- 具体的なコード例を多く書くより、判断基準を短く明確に書いた方がコンテキスト効率が良かった。
- ルールは長さよりも、「何を守らせるか」が明確であることの方が重要だった。

## 6. 課題と今後のアクション

- ユニット内でガイドを共有し、実際の案件で利用したフィードバックを回収する。
- ルール評価ポリシー自体も、判定基準や記録タイミングを見直し、記録精度が安定するように改善する。
- 月1回を目安に、ルール評価ポリシーを使って未使用ルールや曖昧な表現を見直し、追加・修正・削除を行う。
- 複数案件で試験導入し、どの条件で効果が出やすいかを比較できるようにする。
- レビュー指摘件数や手戻り件数などの指標を定め、定量的な効果測定を行う。
- 案件共通で使うテンプレートと、案件固有で追記する情報を分離した運用を標準化する。
