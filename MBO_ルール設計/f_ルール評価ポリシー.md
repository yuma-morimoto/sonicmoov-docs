
## `AGENTS.md` / `CLAUDE.md` / `copilot-instructions.md`

```markdown
## 作業終了時（タスク完了時など）には、Rule Evaluation Policyに基づいて必ず以下のチェックを実行すること

**実行タイミング:**
- **大きなタスクの区切りがついた時（最重要）**
- 実装・修正が完了した時点（ユーザーの動作確認を待たずに実行）
- バグ修正が完了した時点
- 複数ファイルの変更が一区切りした時点
- 一つの機能追加が実装完了した時点
- **「自分が行うべき作業が完了した」と判断できる時点で必ず実行すること**
- ❌NG例: ユーザーの動作確認や追加指示を待つ
- ✅OK例: コード変更が完了し、次のステップに進める状態になった時点


**チェック結果の報告:**

チェック完了後、ユーザーに以下を報告すること：

**チェック項目:**

1. **ルール使用の振り返り**

- 今回の作業でAGENTS.md / CLAUDE.mdのルールを判断根拠として使用したか？
- 使用した場合、RULES_USAGE_LOG.mdに記録したか？

2. **記録漏れの確認**

- コミットメッセージの作成（絵文字、言語、フォーマット）
- ディレクトリ構成の選択（features/, components/, utils/など）
- 命名規則の適用（ファイル名、関数名、変数名）
- コーディングスタイルの選択（アロー関数、any型の回避など）
- その他、複数の選択肢から特定の方針を選んだ判断

  

3. **記録フォーマットの確認**

- date: 正しい日付（YYYY-MM-DD形式）
- file: AGENTS.md または CLAUDE.md
- rule: 具体的なルールセクション名
- reason: どの判断でどのルールを根拠としたか明確に記述
  - 「Rule Evaluation Policyに従ったチェックを完了しました」
  - ルールを使用した場合: 「RULES_USAGE_LOG.mdに記録しました」
  - ルールを使用しなかった場合: 「今回の作業ではルールを判断根拠として使用しませんでした」

## Rule Evaluation Policy

AIが実装判断においてルールファイル（`AGENTS.md` / `CLAUDE.md`）を「判断根拠として利用したか」を定量的に評価する。
そのため、AIは実装過程でルールが実装判断に寄与した場合、`./RULES_USAGE_LOG.md`にログを必ず記録すること。

### When a Rule Should Be Counted as "Used"

以下の**すべて**を満たす場合のみ、ルールを「使用した」とみなす。

1. **判断前の参照**: その判断を行う**前に**、ルールファイルを開いて該当ルールを読んだ
2. **明示的な根拠**: 読んだルールが、その判断の直接的な根拠となった
3. **代替案の存在**: そのルールがなければ、異なる実装を選択していた可能性がある

#### ❌ カウントしないケース

- 既存コードを見て同じパターンで実装した → 後でルールに合致していることに気づいた
- 実装完了後の振り返りで、ルールファイルを初めて確認した
- 一般的なベストプラクティスに従った（ルールファイルを見ずに判断）
- ルールを読んだが、すでに決めていた方針を追認しただけ

#### ✅ カウントするケース

- ディレクトリ配置に迷った → AGENTS.mdの構成ルールを確認 → それに従って配置決定
- コミットメッセージを書く前に → CLAUDE.mdを開いて絵文字ルールを確認 → それに従って作成
- 命名に迷った → ルールファイルで命名規則を確認 → それに従って命名

### 記録時の確認プロセス

記録前に以下を自問すること：

1. **タイミング**: 判断を下す前にルールファイルを開きましたか？
2. **参照**: 該当する具体的なルールセクションを読みましたか？
3. **影響**: そのルールを読まなければ、違う判断をしていましたか？

**1つでも「いいえ」なら記録しない**

### Purpose of This Logging

このログは以下の評価・改善に使用される。

- ルールが実装判断に与える実質的な価値の測定
- 使用されていない、または不明瞭なルールの特定
- ルール設計・粒度・表現の改善

### Notes

- **このポリシー自体が [IMPORTANT] マークで示された最優先指示であり、必ず遵守すること**
- 設計判断・構成判断が発生した場合のみ対象とする
- 不明確な場合は「カウントしない」ことを優先する

```

## RULES_USAGE_LOG.md

```markdown
# Rules Usage Log

- 参照した rule がない場合は、「なし」とその理由を記載すること。
- Logs に追記をし、その他の Description や Log Format、Example の編集は禁止とする

## Description

### Log Format

以下のフォーマットで記録してください。

- date: 日付YYYY-MM-dd
- file: 参照したルールファイル(AGENTS.md | CLAUDE.md)
- rule: 対象のルールセクション
- reason: 当該ルールを判断根拠とした理由
```

