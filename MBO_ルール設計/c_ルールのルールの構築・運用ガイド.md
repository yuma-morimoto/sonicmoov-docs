# ルールの構築・運用ガイド

## この資料のレビュー観点
1. FEU で使いやすいように端的にまとまっていること
2. 恒久的に活用できる資料であること

## 概要
- これはコード生成の AI エージェントルール（`CLAUDE.md` / `.github/copilot-instructions.md` など）を構築し、継続運用するための共有記事です。
- どの案件にも対応できるよう、プロジェクト固有情報とテンプレートを分けて運用できる構成を目指します。

## 推奨構成
- **1. ルールはなぜ必要なのか？**
	- ルールの要不要は案件の開発方針や規模で異なる
	- ルール設計は万能策ではなく、案件固有のガードレールを定義するための手段として扱う
- **2. ルールを構築する**
	- **まずは最小構成で始める**
		- 初めからルールを全部書かず、小さなルールから始める
		- ルールは300行を基準に、それ以上になる場合は簡略化を検討する
	- **ルールテンプレート**
		- [ルールテンプレート](e_ルールテンプレート.md)
		- ルールの決まった構成は存在しない
		- あくまでゼロドラフトで始められるテンプレートであり、構成は自由である
	- **テンプレートに入れる項目**
		- **「実装ガイドライン」について**
			- AI が守るべき判断基準や実装上の制約を書く
		- **「ドメイン用語」について**
			- 案件固有の用語や一般と意味が異なる言葉を定義する
		- **「ディレクトリ構成」について**
			- ディレクトリ構成とその役割を書くと場所を迷わない
	- **構築時の書き方の原則**
		- 具体的なコードは書かない
		- 具体的なコードを用いたルールはコンテキストを圧迫し、効果も限定的なため、特別な理由がない限り書かない
		- コーディングスタイルの指示を書く
		- 「関数の宣言はアロー関数を使用する」「`any` を使わない」「`const` を使う」など、現状のモデルではまだ明示した方が安全なルールを書く
		- ビジネスルールを書く
		- ドメイン用語など案件固有の知識を優先して書く
		- ルールは AI に草案を作らせる
		- 体裁を整えた初稿を作らせ、人間が取捨選択する
- **3. ルールを運用する**
	- **ルールファイルの管理方針**
		- ルールファイルは `git` 管理から除外し、`*.example` は `git` 管理する
		- 新規アサインのメンバーがすぐ使えるように `*.example` を用意し、それをベースに各自がローカルでカスタマイズする
		- 使用するモデルや環境により最適なルールが変わるため、ignore して「自由にいじってよい」状態にする
	- **ルール評価ポリシーでルールを評価する**
		- 守られたか、レビュー指摘が減ったか、手戻りが減ったかで効果を判断する
		- 失敗やレビュー指摘を根拠に、追加・修正の要否を判断する
- **4. 注意点**
	- **ルールの自己改善はまだ難しい**
		- AI 自身にルールの自己改善をやらせるのはまだ難しい
		- 草案は出させても、採用判断は人間が行う
